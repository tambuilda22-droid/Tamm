local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

--- [ ğŸ­Cáº¤U HÃŒNH Há»† THá»NG ] ---
local Window = Rayfield:CreateWindow({
   Name = "ğŸŒ TÃ¢mVIPâ„- ModVip v4.1 (Updated)",
   LoadingTitle = "ğŸ­TÃ¢m DEV SiÃªu Cáº¥p...",
   LoadingSubtitle = "ğŸŒ by TÃ¢m06ğŸŒ€ | Target Gáº§n Nháº¥t",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "TÃ¢mDev_Configs", 
      FileName = "MainConfig"
   },   
   KeySystem = false 
})

--- [ğŸ­KHá»I Táº O BIáº¾N ] ---
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local lp = Players.LocalPlayer
local remoteF = ReplicatedStorage:WaitForChild("RemoteEventF")

local settings = {
    range = 500,
    damage_mult = 10
}

getgenv().settings = {
    damage_mult = 10,
    attack_speed = 0.1,
    range = 500,
    true_damage = true
}

-- Há»‡ thá»‘ng Hooks
local hooks = {
    walkspeed = 40,
    jumppower = 100
}

_G.AutoFarmCoin = false
_G.AutoKillLan = false
_G.GodMode = false
_G.NoRecoil = false
_G.NoReload = false
_G.ESP_Zombie = false
_G.SmartScan = false

--- [ ğŸ­Há»† THá»NG BYPASS HOOKS - GIá»® NGUYÃŠN ] ---
local originalIndex
local originalNewIndex

originalIndex = hookmetamethod(game, "__index", function(self, property)
    if not checkcaller() and self:IsA("Humanoid") and self:IsDescendantOf(lp.Character) then
        local lowerProperty = property:lower()
        if hooks[lowerProperty] then
            return hooks[lowerProperty]
        end
    end
    return originalIndex(self, property)
end)

originalNewIndex = hookmetamethod(game, "__newindex", function(self, property, value)
    if not checkcaller() and self:IsA("Humanoid") and self:IsDescendantOf(lp.Character) then
        local lowerProperty = property:lower()
        if hooks[lowerProperty] then
            hooks[lowerProperty] = value
            return
        end
    end
    
    if _G.NoRecoil and not checkcaller() and (property == "Recoil" or property == "Shake") then
        return originalNewIndex(self, property, 0)
    end
    
    return originalNewIndex(self, property, value)
end)

--- [ ğŸ­TABS ] ---
local FarmTab = Window:CreateTab("ğŸ’£ Auto Farm", "bomb")
local PlayerTab = Window:CreateTab("âš¡ Player", "user")
local WeaponTab = Window:CreateTab("ğŸ”« VÅ© KhÃ­", "crosshair")
local VisualTab = Window:CreateTab("ğŸ‘ï¸ Hiá»ƒn Thá»‹", "eye")

--- [âš¡ TAB AUTO FARM ] ---
FarmTab:CreateSection("Æ¯u TiÃªn Má»¥c TiÃªu Gáº§n Nháº¥t - Damage x10")

FarmTab:CreateToggle({
   Name = "ğŸŒ Giáº¿t Cháº­m (â˜ƒï¸SMAW)",
   CurrentValue = false,
   Callback = function(Value) _G.AutoFarmCoin = Value end,
})

FarmTab:CreateToggle({
   Name = "ğŸŒ Giáº¿t Nhanh (â˜ƒï¸PzF 3)",
   CurrentValue = false,
   Callback = function(Value) _G.AutoKillLan = Value end,
})

local lastDamageValue = 5

FarmTab:CreateSlider({
    Name = "ğŸŒ  Há»a lá»±c (â˜ƒï¸ Max SÃ¡t ThÆ°Æ¡ng)",
    Range = {1, 500}, -- Má»Ÿ rá»™ng giá»›i háº¡n náº¿u báº¡n muá»‘n damage cao hÆ¡n
    Increment = 30,
    CurrentValue = lastDamageValue,
    Callback = function(Value)
        -- Cáº­p nháº­t giÃ¡ trá»‹ vÃ o há»‡ thá»‘ng
        settings.damage_mult = Value
        
        -- Logic True Damage & Packet Mode
        if Value <= 1 then
            settings.true_damage = false
            settings.packet_mode = true -- Cháº¿ Ä‘á»™ gá»­i packet gá»‘c
        else
            settings.true_damage = true
            settings.packet_mode = false
            -- Tá»‘i Æ°u: Náº¿u damage quÃ¡ cao, tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh khoáº£ng cÃ¡ch gá»­i (Delay)
            -- giÃºp trÃ¡nh bá»‹ kick (Anti-cheat)
            settings.attack_speed = math.clamp(0.1 / (Value / 10), 0.01, 0.1) 
        end

        lastDamageValue = Value
    end
})

FarmTab:CreateSlider({
    Name = "ğŸŒ  Há»a lá»±c (DÃ­nh Äáº¡n + SÃ¡t ThÆ°Æ¡ng)",
    Range = {1, 500},
    Increment = 10,
    CurrentValue = 5,
    Callback = function(Value)
        settings.damage_mult = Value
        settings.area_radius = Value / 5 -- BÃ¡n kÃ­nh ná»• tá»· lá»‡ thuáº­n vá»›i thanh trÆ°á»£t
        settings.no_ammo_waste = true
        settings.attack_speed = math.clamp(0.1 / (Value / 20), 0.02, 0.1)
    end
})

--- [ ğŸ­TAB PLAYER ] ---
PlayerTab:CreateSection("Chá»‰ sá»‘ nhÃ¢n váº­t")

PlayerTab:CreateToggle({
   Name = "ğŸ•¶ï¸Báº¥t Tá»­ (ğŸŒ€God Mode v2)",
   CurrentValue = false,
   Callback = function(Value) _G.GodMode = Value end,
})

PlayerTab:CreateSlider({
   Name = "ğŸ•¶ï¸Cháº¡y Nhanh (ğŸŒ€WalkSpeed)",
   Range = {16, 300},
   Increment = 1,
   CurrentValue = 40,
   Callback = function(v) 
       hooks.walkspeed = v 
       if lp.Character and lp.Character:FindFirstChild("Humanoid") then
           lp.Character.Humanoid.WalkSpeed = v
       end
   end,
})

--- [ ğŸ­ TAB VÅ¨ KHÃ - ÄÃƒ Tá»I Æ¯U FPS ] ---
WeaponTab:CreateToggle({
   Name = "ğŸŒ Smart Scan V3 (Anti-Lag)",
   CurrentValue = false,
   Callback = function(Value)
      _G.SmartScan = Value
      if Value then
          task.spawn(function()
              while _G.SmartScan do
                  local gc = getgc(true)
                  for i, v in pairs(gc) do
                      if not _G.SmartScan then break end
                      if type(v) == "table" then
                          if rawget(v, "FireRate") or rawget(v, "Recoil") then
                              v.FireRate = 0.001
                              v.Recoil = 0
                              v.Spread = 0
                              v.ReloadTime = 0
                              v.BulletSpeed = 5000
                          end
                      end
                      -- Cá»© 200 báº£ng thÃ¬ nghá»‰ 1 frame Ä‘á»ƒ khÃ´ng bá»‹ drop FPS (Time-slicing)
                      if i % 200 == 0 then task.wait() end 
                  end
                  task.wait(20) -- TÄƒng thá»i gian chá» giá»¯a cÃ¡c láº§n quÃ©t toÃ n cá»¥c
              end
          end)
      end
   end,
})

--- [ğŸ­ Tab Troll & Tiá»‡n Ã­ch ] ---
local TrollTab = Window:CreateTab("ğŸ­ Tiá»‡n Ã­ch & Troll", 4483362458) -- ID icon cÃ³ thá»ƒ thay Ä‘á»•i tÃ¹y Ã½

-- ThÃªm Slider cá»§a báº¡n vÃ o Tab vá»«a táº¡o
TrollTab:CreateSlider({
   Name = "ğŸ“ Äá»™ cao nhÃ¢n váº­t (Troll Zombie)",
   Range = {-5, 20},
   Increment = 1,
   CurrentValue = 2,
   Callback = function(v)
       -- Äáº£m báº£o biáº¿n 'lp' (LocalPlayer) Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a á»Ÿ Ä‘áº§u script
       local lp = game.Players.LocalPlayer
       if lp.Character and lp.Character:FindFirstChild("Humanoid") then
           lp.Character.Humanoid.HipHeight = v
       end
   end,
})

-- ThÃªm má»™t nÃºt vÃ­ dá»¥ khÃ¡c Ä‘á»ƒ Tab bá»›t trá»‘ng tráº£i
TrollTab:CreateButton({
   Name = "ğŸƒ Reset Äá»™ cao",
   Callback = function()
       local lp = game.Players.LocalPlayer
       if lp.Character and lp.Character:FindFirstChild("Humanoid") then
           lp.Character.Humanoid.HipHeight = 2 -- Äá»™ cao máº·c Ä‘á»‹nh
       end
   end,
})

TrollTab:CreateSlider({
   Name = "ğŸ”„ Äá»™ nghiÃªng/Xoay thÃ¢n hÃ¬nh",
   Range = {0, 360},
   Increment = 1,
   CurrentValue = 0,
   Callback = function(v)
       local lp = game.Players.LocalPlayer
       local char = lp.Character
       if not char then return end

       -- Äá»‹nh nghÄ©a gÃ³c xoay dá»±a trÃªn giÃ¡ trá»‹ slider
       local rad = math.rad(v)

       if char:FindFirstChild("LowerTorso") and char.LowerTorso:FindFirstChild("Root") then
           -- DÃ nh cho nhÃ¢n váº­t R15
           char.LowerTorso.Root.C0 = CFrame.new(0, 0, 0) * CFrame.Angles(math.rad(-90), math.rad(180), rad)
       elseif char:FindFirstChild("HumanoidRootPart") and char.HumanoidRootPart:FindFirstChild("RootJoint") then
           -- DÃ nh cho nhÃ¢n váº­t R6
           char.HumanoidRootPart.RootJoint.C0 = CFrame.new(0, 0, 0) * CFrame.Angles(math.rad(-90), math.rad(180), rad)
       end
   end,
})

-- NÃºt Reset nhanh tÆ° tháº¿ vá» máº·c Ä‘á»‹nh
TrollTab:CreateButton({
   Name = "ğŸ”„ Reset TÆ° Tháº¿ (Tháº³ng Ä‘á»©ng)",
   Callback = function()
       local lp = game.Players.LocalPlayer
       local char = lp.Character
       if not char then return end

       local defaultC0 = CFrame.new(0, 0, 0) * CFrame.Angles(math.rad(-90), math.rad(180), 0)

       if char:FindFirstChild("LowerTorso") and char.LowerTorso:FindFirstChild("Root") then
           char.LowerTorso.Root.C0 = defaultC0
       elseif char:FindFirstChild("HumanoidRootPart") and char.HumanoidRootPart:FindFirstChild("RootJoint") then
           char.HumanoidRootPart.RootJoint.C0 = defaultC0
       end
       
       -- ÄÆ°a HipHeight vá» máº·c Ä‘á»‹nh náº¿u cáº§n
       if char:FindFirstChild("Humanoid") then
           char.Humanoid.HipHeight = 2
       end
   end,
})

--- [ ğŸ­TAB HIá»‚N THá»Š ] ---
VisualTab:CreateSection("Visuals")

VisualTab:CreateToggle({
   Name = "ğŸ•¶ï¸Esp Zombie (ğŸŒ€Highlight)",
   CurrentValue = false,
   Callback = function(Value) _G.ESP_Zombie = Value end,
})

--- [ âš¡Há»† THá»NG VÃ’NG Láº¶P CORE ] ---

-- God Mode Loop
RunService.Heartbeat:Connect(function()
    if _G.GodMode and lp.Character and lp.Character:FindFirstChild("Humanoid") then
        lp.Character.Humanoid.Health = lp.Character.Humanoid.MaxHealth
    end
end)

-- Farm Loop (âš¡Báº¢N NÃ‚NG Cáº¤P: DÃNH Äáº N + DAMAGE CAO)
task.spawn(function()
    while task.wait() do -- Sá»­ dá»¥ng task.wait() máº·c Ä‘á»‹nh Ä‘á»ƒ mÆ°á»£t hÆ¡n
        if _G.AutoFarmCoin or _G.AutoKillLan then
            local char = lp.Character
            local head = char and char:FindFirstChild("Head")
            local enemies = workspace:FindFirstChild("Zombies") or workspace:FindFirstChild("Enemies")
            
            if head and enemies then
                local target = nil
                local dist = settings.range

                -- QuÃ©t tÃ¬m má»¥c tiÃªu gáº§n nháº¥t
                for _, z in ipairs(enemies:GetChildren()) do
                    local zRoot = z:FindFirstChild("HumanoidRootPart")
                    local zHum = z:FindFirstChild("Humanoid")
                    
                    if zRoot and zHum and zHum.Health > 0 then
                        local magnitude = (zRoot.Position - head.Position).Magnitude
                        if magnitude < dist then
                            dist = magnitude
                            target = z
                        end
                    end
                end

                -- Náº¿u tÃ¬m tháº¥y má»¥c tiÃªu
                if target then
                    local zRoot = target:FindFirstChild("HumanoidRootPart")
                    local weapon = _G.AutoKillLan and "PzF 3" or "SMAW"
                    
                    -- Ã‰P Tá»ŒA Äá»˜ DÃNH VÃ€O Má»¤C TIÃŠU (Sá»­a lá»—i bay xuyÃªn)
                    local args = {
                        [1] = {
                            ["ModelType"] = "Character",
                            ["TargetPos"] = zRoot.Position, -- LuÃ´n báº¯n vÃ o tÃ¢m quÃ¡i
                            ["Model"] = target,
                            ["PlayerName"] = lp.Name,
                            ["WeaponName"] = weapon,
                            ["SourcePart"] = head,
                            ["SourcePos"] = head.Position
                        }
                    }
                    
                    -- Gá»¬I PACKET THEO Tá»C Äá»˜ Cá»¦A SLIDER
                    -- settings.damage_mult chÃ­nh lÃ  sá»‘ láº§n nhÃ¢n sÃ¡t thÆ°Æ¡ng
                    for i = 1, (settings.damage_mult or 10) do
                        remoteF:FireServer(unpack(args))
                    end
                    
                    -- Khoáº£ng nghá»‰ dá»±a trÃªn Slider Ä‘á»ƒ trÃ¡nh bá»‹ kick (Anti-cheat)
                    task.wait(settings.attack_speed or 0.1) 
                end
            end
        end
    end
end)

task.spawn(function()
    while true do 
        task.wait(settings.attack_speed or 0.1)
        if _G.AutoFarmCoin or _G.AutoKillLan then
            -- ... (Ä‘oáº¡n code báº¯n Ä‘áº¡n mÃ¬nh vá»«a tá»‘i Æ°u á»Ÿ trÃªn) ...
        end
    end
end)

local function SetupESP(zombie)
    -- Chá» 0.5 giÃ¢y Ä‘á»ƒ Zombie load Ä‘á»§ cÃ¡c bá»™ pháº­n tá»« Server
    task.wait(0.5)
    
    if _G.ESP_Zombie and zombie:IsA("Model") then
        -- Kiá»ƒm tra xem Ä‘Ã£ cÃ³ Highlight chÆ°a Ä‘á»ƒ trÃ¡nh trÃ¹ng láº·p
        if not zombie:FindFirstChild("Highlight") then
            local hl = Instance.new("Highlight")
            hl.Parent = zombie
            hl.FillColor = Color3.fromRGB(255, 0, 0)
            hl.OutlineColor = Color3.fromRGB(255, 255, 255)
            hl.FillTransparency = 0.5
        end
    end
end

-- Káº¿t ná»‘i vá»›i Folder chá»©a Zombie
local enemyFolder = workspace:FindFirstChild("Zombies") or workspace:FindFirstChild("Enemies")

if enemyFolder then
    -- Khi cÃ³ má»™t con Zombie má»›i xuáº¥t hiá»‡n trong Folder
    enemyFolder.ChildAdded:Connect(function(newChild)
        SetupESP(newChild)
    end)
end

Rayfield:Notify({
   Title = "ğŸ•¶ï¸ TÃ¢mÄáº¹pZaiiâ„ï¸",
   Content = "Há»‡ thá»‘ng v4 (Target Gáº§n Nháº¥t) Ä‘Ã£ sáºµn sÃ ng!",
   Duration = 5,
})
