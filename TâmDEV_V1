local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

--- [ ğŸ­Cáº¤U HÃŒNH Há»† THá»NG ] ---
local Window = Rayfield:CreateWindow({
   Name = "ğŸŒ TÃ¢mVIPâ„- ModVip v4.1 (Updated)",
   LoadingTitle = "Äang Náº¡p SiÃªu Cáº¥p...",
   LoadingSubtitle = "ğŸŒ by TÃ¢m06ğŸŒ€ | Target Gáº§n Nháº¥t",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "TamVIP_Configs", 
      FileName = "MainConfig"
   },
   KeySystem = false 
})

--- [ğŸ­KHá»I Táº O BIáº¾N ] ---
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local lp = Players.LocalPlayer
local remoteF = ReplicatedStorage:WaitForChild("RemoteEventF")

local settings = {
    range = 500,
    damage_mult = 10
}

-- Há»‡ thá»‘ng Hooks
local hooks = {
    walkspeed = 40,
    jumppower = 100
}

_G.AutoFarmCoin = false
_G.AutoKillLan = false
_G.GodMode = false
_G.NoRecoil = false
_G.NoReload = false
_G.ESP_Zombie = false

--- [ ğŸ­Há»† THá»NG BYPASS HOOKS - GIá»® NGUYÃŠN ] ---
local originalIndex
local originalNewIndex

originalIndex = hookmetamethod(game, "__index", function(self, property)
    if not checkcaller() and self:IsA("Humanoid") and self:IsDescendantOf(lp.Character) then
        local lowerProperty = property:lower()
        if hooks[lowerProperty] then
            return hooks[lowerProperty]
        end
    end
    return originalIndex(self, property)
end)

originalNewIndex = hookmetamethod(game, "__newindex", function(self, property, value)
    if not checkcaller() and self:IsA("Humanoid") and self:IsDescendantOf(lp.Character) then
        local lowerProperty = property:lower()
        if hooks[lowerProperty] then
            hooks[lowerProperty] = value
            return
        end
    end
    
    if _G.NoRecoil and not checkcaller() and (property == "Recoil" or property == "Shake") then
        return originalNewIndex(self, property, 0)
    end
    
    return originalNewIndex(self, property, value)
end)

--- [ ğŸ­TABS ] ---
local FarmTab = Window:CreateTab("ğŸ’£ Auto Farm", "bomb")
local PlayerTab = Window:CreateTab("âš¡ Player", "user")
local WeaponTab = Window:CreateTab("ğŸ”« VÅ© KhÃ­", "crosshair")
local VisualTab = Window:CreateTab("ğŸ‘ï¸ Hiá»ƒn Thá»‹", "eye")

--- [âš¡ TAB AUTO FARM ] ---
FarmTab:CreateSection("Æ¯u TiÃªn Má»¥c TiÃªu Gáº§n Nháº¥t - Damage x10")

FarmTab:CreateToggle({
   Name = "ğŸŒ Giáº¿t Cháº­m (â˜ƒï¸SMAW)",
   CurrentValue = false,
   Callback = function(Value) _G.AutoFarmCoin = Value end,
})

FarmTab:CreateToggle({
   Name = "ğŸŒ Giáº¿t Nhanh (â˜ƒï¸PzF 3)",
   CurrentValue = false,
   Callback = function(Value) _G.AutoKillLan = Value end,
})

local lastDamageValue = 5

FarmTab:CreateSlider({
    Name = "ğŸŒ  Há»a lá»±c (â˜ƒï¸ Max SÃ¡t ThÆ°Æ¡ng)",
    Range = {1, 200}, -- Má»Ÿ rá»™ng giá»›i háº¡n náº¿u báº¡n muá»‘n damage cao hÆ¡n
    Increment = 10,
    CurrentValue = lastDamageValue,
    Callback = function(Value)
        -- Cáº­p nháº­t giÃ¡ trá»‹ vÃ o há»‡ thá»‘ng
        settings.damage_mult = Value
        
        -- Logic True Damage & Packet Mode
        if Value <= 1 then
            settings.true_damage = false
            settings.packet_mode = true -- Cháº¿ Ä‘á»™ gá»­i packet gá»‘c
        else
            settings.true_damage = true
            settings.packet_mode = false
            -- Tá»‘i Æ°u: Náº¿u damage quÃ¡ cao, tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh khoáº£ng cÃ¡ch gá»­i (Delay)
            -- giÃºp trÃ¡nh bá»‹ kick (Anti-cheat)
            settings.attack_speed = math.clamp(0.1 / (Value / 10), 0.01, 0.1) 
        end

        lastDamageValue = Value
    end
})

--- [ ğŸ­TAB PLAYER ] ---
PlayerTab:CreateSection("Chá»‰ sá»‘ nhÃ¢n váº­t")

PlayerTab:CreateToggle({
   Name = "ğŸ•¶ï¸Báº¥t Tá»­ (ğŸŒ€God Mode v2)",
   CurrentValue = false,
   Callback = function(Value) _G.GodMode = Value end,
})

PlayerTab:CreateSlider({
   Name = "ğŸ•¶ï¸Cháº¡y Nhanh (ğŸŒ€WalkSpeed)",
   Range = {16, 300},
   Increment = 1,
   CurrentValue = 40,
   Callback = function(v) 
       hooks.walkspeed = v 
       if lp.Character and lp.Character:FindFirstChild("Humanoid") then
           lp.Character.Humanoid.WalkSpeed = v
       end
   end,
})

--- [ ğŸ­TAB VÅ¨ KHÃ ] ---
WeaponTab:CreateSection("Weapon Modifications")

WeaponTab:CreateToggle({
   Name = "ğŸŒ No Giáº­t SÃºng (ğŸ”«No Recoil)",
   CurrentValue = false,
   Callback = function(Value) _G.NoRecoil = Value end,
})

WeaponTab:CreateToggle({
   Name = "ğŸŒ Smart Scan V2 (ğŸ”«SiÃªu Cáº¥p + Äáº¡n Tá»©c Thá»i)",
   CurrentValue = false,
   Callback = function(Value)
      _G.SmartScan = Value
      if Value then
          task.spawn(function()
              while _G.SmartScan do
                  -- QuÃ©t toÃ n bá»™ báº£ng dá»¯ liá»‡u trong bá»™ nhá»› mÃ¡y áº£o
                  for _, v in pairs(getgc(true)) do
                      if type(v) == "table" then
                          
                          -- [1] Tá»C Äá»˜ Äáº N & CHÃNH XÃC (Bullet Speed 3000)
                          -- Chá»‰nh táº¥t cáº£ cÃ¡c biáº¿n liÃªn quan Ä‘áº¿n tá»‘c Ä‘á»™ bay cá»§a Ä‘áº¡n
                          local bulletStats = {
                              "BulletSpeed", "MuzzleVelocity", "ProjectileSpeed", 
                              "Velocity", "Speed", "TravelSpeed"
                          }
                          for _, stat in ipairs(bulletStats) do
                              if rawget(v, stat) and type(v[stat]) == "number" then
                                  v[stat] = 3000 -- Äáº¡n bay khÃ´ng chá» Ä‘á»£i
                              end
                          end

                          -- [2] Tá»° Äá»˜NG HÃ“A & DPS MAX
                          if rawget(v, "FireMode") or rawget(v, "Mode") then
                              v.FireMode = "Auto"
                              v.Mode = "Auto"
                          end
                          
                          local fastStats = {
                             "FireRate", "Delay", "ShootDelay", "TimeBetweenShots", 
                             "ReloadTime", "ReloadDuration", "EmptyReloadTime",
                             "RecoveryTime", "RecoilReturnSpeed"
                          }
                          for _, stat in ipairs(fastStats) do
                              if rawget(v, stat) then
                                  v[stat] = 0.01 -- Ã‰p tá»‘c Ä‘á»™ báº¯n lÃªn má»©c tá»‘i Ä‘a
                              end
                          end

                          -- [3] XÃ“A Äá»˜ GIáº¬T & Äá»˜ Lá»†CH (Zero Spread)
                          if rawget(v, "Spread") or rawget(v, "MaxSpread") then
                              v.Spread = 0.1
                              v.MaxSpread = 0.1
                              v.MinSpread = 0.1
                          end
                      end
                  end
                  task.wait(3) -- QuÃ©t láº¡i sau má»—i 3s Ä‘á»ƒ Ã¡p dá»¥ng cho sÃºng má»›i
              end
          end)
      end
   end,
})

--- [ ğŸ­TAB TROLL - ÄÃƒ Cáº¬P NHáº¬T ] ---
local TrollTab = Window:CreateTab("ğŸ¤¡ Troll Menu", "ghost")

TrollTab:CreateSection("TÃ­nh nÄƒng Ä‘áº©y & phÃ¡ Zombie")

TrollTab:CreateButton({
    Name = "ğŸ›¡ï¸ Äáº©y Zombie Ra Xa (Full Map)",
    Callback = function()
        local character = lp.Character
        local myRoot = character and character:FindFirstChild("HumanoidRootPart")
        local pushDistance = 30 -- TÄƒng lÃªn 30m cho gáº¯t

        if myRoot then
            local count = 0
            -- QuÃ©t toÃ n bá»™ Workspace Ä‘á»ƒ tÃ¬m báº¥t cá»© thá»© gÃ¬ cÃ³ Humanoid (trá»« báº¡n)
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:IsA("Humanoid") and obj.Parent ~= character then
                    local zRoot = obj.Parent:FindFirstChild("HumanoidRootPart")
                    if zRoot then
                        -- TÃ­nh toÃ¡n hÆ°á»›ng vÃ  Ä‘áº©y
                        local direction = (zRoot.Position - myRoot.Position).Unit
                        -- Sá»­ dá»¥ng CFrame.new Ä‘á»ƒ trÃ¡nh lá»—i cá»™ng Vector trá»±c tiáº¿p
                        zRoot.CFrame = CFrame.new(zRoot.Position + (direction * pushDistance))
                        count = count + 1
                    end
                end
            end

            Rayfield:Notify({
                Title = "ThÃ nh cÃ´ng!",
                Content = "ÄÃ£ Ä‘áº©y bay " .. tostring(count) .. " má»¥c tiÃªu!",
                Duration = 2,
                Image = "rewind",
            })
        else
            Rayfield:Notify({
                Title = "Lá»—i",
                Content = "KhÃ´ng tÃ¬m tháº¥y HumanoidRootPart cá»§a báº¡n!",
                Duration = 2,
            })
        end
    end,
})

TrollTab:CreateSlider({
   Name = "ğŸ“ Äá»™ cao nhÃ¢n váº­t (Troll Zombie)",
   Range = {-5, 20},
   Increment = 1,
   CurrentValue = 2,
   Callback = function(v)
       if lp.Character and lp.Character:FindFirstChild("Humanoid") then
           lp.Character.Humanoid.HipHeight = v
       end
   end,
})

local ghostEnabled = false
TrollTab:CreateToggle({
    Name = "ğŸ‘» Cháº¿ Ä‘á»™ Linh Há»“n (TÃ ng hÃ¬nh)",
    CurrentValue = false,
    Callback = function(Value)
        ghostEnabled = Value
        for _, part in pairs(lp.Character:GetChildren()) do
            if part:IsA("BasePart") or part:IsA("MeshPart") then
                part.Transparency = ghostEnabled and 0.5 or 0 -- Äá»™ má» 50%
            elseif part:IsA("Accessory") and part:FindFirstChild("Handle") then
                part.Handle.Transparency = ghostEnabled and 0.5 or 0
            end
        end
    end
})

--- [ ğŸ­TAB HIá»‚N THá»Š ] ---
VisualTab:CreateSection("Visuals")

VisualTab:CreateToggle({
   Name = "ğŸ•¶ï¸Esp Zombie (ğŸŒ€Highlight)",
   CurrentValue = false,
   Callback = function(Value) _G.ESP_Zombie = Value end,
})

--- [ âš¡Há»† THá»NG VÃ’NG Láº¶P CORE ] ---

-- God Mode Loop
RunService.Heartbeat:Connect(function()
    if _G.GodMode and lp.Character and lp.Character:FindFirstChild("Humanoid") then
        lp.Character.Humanoid.Health = lp.Character.Humanoid.MaxHealth
    end
end)

-- Farm Loop (âš¡Sá»¬A Láº I Äá»‚ Æ¯U TIÃŠN CON Gáº¦N NHáº¤T)
task.spawn(function()
    while task.wait(0.1) do 
        if _G.AutoFarmCoin or _G.AutoKillLan then
            local char = lp.Character
            local head = char and char:FindFirstChild("Head")
            local enemies = workspace:FindFirstChild("Zombies") or workspace:FindFirstChild("Enemies")
            
            if head and enemies then
                local target = nil
                local dist = settings.range

                -- QuÃ©t tÃ¬m má»¥c tiÃªu gáº§n nháº¥t trong Range
                for _, z in ipairs(enemies:GetChildren()) do
                    local zRoot = z:FindFirstChild("HumanoidRootPart")
                    local zHum = z:FindFirstChild("Humanoid")
                    
                    if zRoot and zHum and zHum.Health > 0 then
                        local magnitude = (zRoot.Position - head.Position).Magnitude
                        if magnitude < dist then
                            dist = magnitude
                            target = z
                        end
                    end
                end

                -- Náº¿u tÃ¬m tháº¥y con gáº§n nháº¥t thÃ¬ thá»±c hiá»‡n báº¯n
                if target then
                    local zRoot = target:FindFirstChild("HumanoidRootPart")
                    local weapon = _G.AutoKillLan and "PzF 3" or "SMAW"
                    local args = {
                        [1] = {
                            ["ModelType"] = "Character",
                            ["TargetPos"] = zRoot.Position,
                            ["Model"] = target,
                            ["PlayerName"] = lp.Name,
                            ["WeaponName"] = weapon,
                            ["SourcePart"] = head,
                            ["SourcePos"] = head.Position
                        }
                    }
                    
                    -- VÃ²ng láº·p gá»­i packets sÃ¡t thÆ°Æ¡ng (Giá»¯ nguyÃªn logic cÅ©)
                    for i = 1, settings.damage_mult do
                        remoteF:FireServer(unpack(args))
                    end
                end
            end
        end
    end
end)

local function SetupESP(zombie)
    -- Chá» 0.5 giÃ¢y Ä‘á»ƒ Zombie load Ä‘á»§ cÃ¡c bá»™ pháº­n tá»« Server
    task.wait(0.5)
    
    if _G.ESP_Zombie and zombie:IsA("Model") then
        -- Kiá»ƒm tra xem Ä‘Ã£ cÃ³ Highlight chÆ°a Ä‘á»ƒ trÃ¡nh trÃ¹ng láº·p
        if not zombie:FindFirstChild("Highlight") then
            local hl = Instance.new("Highlight")
            hl.Parent = zombie
            hl.FillColor = Color3.fromRGB(255, 0, 0)
            hl.OutlineColor = Color3.fromRGB(255, 255, 255)
            hl.FillTransparency = 0.5
        end
    end
end

-- Káº¿t ná»‘i vá»›i Folder chá»©a Zombie
local enemyFolder = workspace:FindFirstChild("Zombies") or workspace:FindFirstChild("Enemies")

if enemyFolder then
    -- Khi cÃ³ má»™t con Zombie má»›i xuáº¥t hiá»‡n trong Folder
    enemyFolder.ChildAdded:Connect(function(newChild)
        SetupESP(newChild)
    end)
end

Rayfield:Notify({
   Title = "ğŸ•¶ï¸ TÃ¢mÄáº¹pZaiiâ„ï¸",
   Content = "Há»‡ thá»‘ng v4 (Target Gáº§n Nháº¥t) Ä‘Ã£ sáºµn sÃ ng!",
   Duration = 5,
})
